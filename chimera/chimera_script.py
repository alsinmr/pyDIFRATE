try:
	from chimerax.core.commands import run as rc

	import os
	import numpy as np

	di=np.array([2130,2134,2136,2138,2139,2140,2141,2142,2145,2146,\
		2147,2148,2149,2150,2151,2153,2161,2163,2165,2167,\
		2168,2169,2170,2171,2172,2173,2175,2177,2179,2180,\
		2181,2182,2183,2186,2187,2188,2189,2190,2191,2192,\
		2194,2196,2198,2199,2200,2201,2202,2203,2204,2205,\
		2206,2207,2208,2210,2213,2215,2217,2237,2239,2241,\
		2251,2253,2255,2262,2264,2266,2268,2269,2270,2271,\
		2272,2273,2274,2276,2294,2296,2298,2306,2308,2310,\
		2312,2314,2315,2316,2317,2318,2321,2322,2323,2324,\
		2325,2326,2327,2329,2349,2351,2353,2363,2365,2367,\
		2378,2380,2382,2393,2395,2397,2417,2419,2421,2423,\
		2424,2425,2426,2427,2428,2429,2431,2451,2453,2455,\
		2457,2459,2460,2461,2462,2463,2464,2465,2466,2467,\
		2468,2469,2471,2484,2486,2488,2490,2493,2495,2496,\
		2497,2498,2499,2500,2501,2502,2503,2504,2505,2507,\
		2510,2512,2514,2524,2526,2528,2530,2532,2533,2534,\
		2535,2536,2537,2538,2539,2540,2541,2542,2544,2546,\
		2548,2549,2550,2551,2552,2553,2554,2555,2556,2557,\
		2558,2560,2570,2572,2574,2576,2577,2578,2579,2580,\
		2581,2582,2584,2586,2587,2588,2589,2590,2591,2592,\
		2594,2596,2597,2598,2599,2600,2601,2602,2604,2606,\
		2609,2611,2612,2613,2614,2615,2616,2617,2618,2619,\
		2620,2621,2623,2636,2638,2640,2643,2645,2647,2650,\
		2652,2654,2656,2658,2659,2660,2661,2662,2665,2666,\
		2667,2668,2669,2670,2671,2673,2693,2695,2697,2699,\
		2701,2702,2703,2704,2705,2708,2709,2710,2711,2712,\
		2713,2714,2716,2723,2725,2727,2735,2737,2739,2752,\
		2754,2756,2766,2768,2770,2780,2782,2784,2794,2796,\
		2798,2805,2807,2809,2811,2813,2814,2815,2816,2817,\
		2818,2819,2820,2821,2822,2823,2825,2836,2838,2840,\
		2850,2852,2854,2856,2858,2859,2860,2861,2862,2863,\
		2864,2865,2866,2867,2868,2870,2872,2874,2875,2876,\
		2877,2878,2879,2880,2881,2882,2883,2884,2886,2889,\
		2891,2893,2911,2913,2915,2918,2920,2922,2933,2935,\
		2937,2944,2946,2948,2968,2970,2972,2974,2976,2977,\
		2978,2979,2980,2981,2982,2983,2984,2985,2986,2988,\
		2990,2993,2995,2996,2997,2998,2999,3000,3001,3002,\
		3003,3004,3005,3007,3009,3011,3012,3013,3014,3015,\
		3018,3019,3020,3021,3022,3023,3024,3026,3029,3031,\
		3033,3043,3045,3047,3058,3060,3062,3079,3081,3083,\
		3086,3088,3090,3093,3095,3097,3115,3117,3119,3122,\
		3124,3126,3142,3144,3146,3166,3168,3170,3178,3180,\
		3182,3192]).astype("uint32")

	ids=np.array([2136,2138,2139,2140,2141,2142,2145,2146,2147,2148,\
		2165,2167,2168,2169,2170,2177,2179,2180,2181,2182,\
		2183,2186,2187,2188,2189,2196,2198,2199,2200,2201,\
		2202,2203,2204,2205,2266,2268,2269,2270,2271,2312,\
		2314,2315,2316,2317,2318,2321,2322,2323,2324,2421,\
		2423,2424,2425,2426,2457,2459,2460,2461,2462,2463,\
		2464,2465,2466,2493,2495,2496,2497,2498,2499,2500,\
		2501,2502,2530,2532,2533,2534,2535,2536,2537,2538,\
		2539,2546,2548,2549,2550,2551,2552,2553,2554,2555,\
		2574,2576,2577,2578,2579,2584,2586,2587,2588,2589,\
		2594,2596,2597,2598,2599,2609,2611,2612,2613,2614,\
		2615,2616,2617,2618,2656,2658,2659,2660,2661,2662,\
		2665,2666,2667,2668,2699,2701,2702,2703,2704,2705,\
		2708,2709,2710,2711,2811,2813,2814,2815,2816,2817,\
		2818,2819,2820,2856,2858,2859,2860,2861,2862,2863,\
		2864,2865,2872,2874,2875,2876,2877,2878,2879,2880,\
		2881,2974,2976,2977,2978,2979,2980,2981,2982,2983,\
		2993,2995,2996,2997,2998,2999,3000,3001,3002,3009,\
		3011,3012,3013,3014,3015,3018,3019,3020,3021]).astype("uint32")

	r=np.array([0.970465,0.970465,0.970465,0.970465,0.970465,0.979662,0.979662,0.979662,0.979662,0.979662,\
		0.929916,0.929916,0.929916,0.929916,0.929916,3.324917,3.324917,3.324917,3.324917,3.324917,\
		1.208864,1.208864,1.208864,1.208864,1.208864,2.377263,3.329248,3.329248,3.329248,3.329248,\
		1.425278,1.425278,1.425278,1.425278,1.120654,1.120654,1.120654,1.120654,1.120654,0.947376,\
		0.947376,0.947376,0.947376,0.947376,0.900000,0.900000,0.900000,0.900000,0.900000,0.920235,\
		0.920235,0.920235,0.920235,0.920235,0.976904,0.998865,0.998865,0.998865,0.998865,0.954943,\
		0.954943,0.954943,0.954943,2.622155,3.692643,3.692643,3.692643,3.692643,1.551668,1.551668,\
		1.551668,1.551668,0.900000,0.900000,0.900000,0.900000,0.900000,0.900000,0.900000,0.900000,\
		0.900000,0.900000,0.900000,0.900000,0.900000,0.900000,0.900000,0.900000,0.900000,0.900000,\
		4.368501,4.368501,4.368501,4.368501,4.368501,1.840522,1.840522,1.840522,1.840522,1.840522,\
		1.482040,1.482040,1.482040,1.482040,1.482040,1.492534,1.075038,1.075038,1.075038,1.075038,\
		1.910030,1.910030,1.910030,1.910030,2.048036,2.048036,2.048036,2.048036,2.048036,0.912057,\
		0.912057,0.912057,0.912057,0.912057,0.900000,0.900000,0.900000,0.900000,0.900000,0.900000,\
		0.900000,0.900000,0.900000,0.900000,4.900000,4.900000,4.900000,4.900000,4.900000,4.900000,\
		4.900000,4.900000,4.900000,1.452452,1.584044,1.584044,1.584044,1.584044,1.320860,1.320860,\
		1.320860,1.320860,2.094615,2.022151,2.022151,2.022151,2.022151,2.167079,2.167079,2.167079,\
		2.167079,0.900000,0.900000,0.900000,0.900000,0.900000,0.900000,0.900000,0.900000,0.900000,\
		0.946223,0.943667,0.943667,0.943667,0.943667,0.948779,0.948779,0.948779,0.948779,1.071667,\
		1.071667,1.071667,1.071667,1.071667,1.008079,1.008079,1.008079,1.008079,1.008079]).astype("float")

	clr=np.array([[208,178,140,255],
		[208,178,140,255],
		[208,178,140,255],
		[208,178,140,255],
		[208,178,140,255],
		[208,178,140,255],
		[208,178,140,255],
		[208,178,140,255],
		[208,178,140,255],
		[208,178,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[172,133,169,255],
		[172,133,169,255],
		[172,133,169,255],
		[172,133,169,255],
		[172,133,169,255],
		[205,174,143,255],
		[205,174,143,255],
		[205,174,143,255],
		[205,174,143,255],
		[205,174,143,255],
		[187,151,158,255],
		[172,133,169,255],
		[172,133,169,255],
		[172,133,169,255],
		[172,133,169,255],
		[201,169,146,255],
		[201,169,146,255],
		[201,169,146,255],
		[201,169,146,255],
		[206,175,142,255],
		[206,175,142,255],
		[206,175,142,255],
		[206,175,142,255],
		[206,175,142,255],
		[209,179,140,254],
		[209,179,140,254],
		[209,179,140,254],
		[209,179,140,254],
		[209,179,140,254],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[208,178,140,254],
		[208,178,141,255],
		[208,178,141,255],
		[208,178,141,255],
		[208,178,141,255],
		[209,178,140,254],
		[209,178,140,254],
		[209,178,140,254],
		[209,178,140,254],
		[183,146,161,255],
		[166,126,174,255],
		[166,126,174,255],
		[166,126,174,255],
		[166,126,174,255],
		[199,167,147,255],
		[199,167,147,255],
		[199,167,147,255],
		[199,167,147,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[156,113,182,255],
		[156,113,182,255],
		[156,113,182,255],
		[156,113,182,255],
		[156,113,182,255],
		[195,161,151,255],
		[195,161,151,255],
		[195,161,151,255],
		[195,161,151,255],
		[195,161,151,255],
		[200,168,147,255],
		[200,168,147,255],
		[200,168,147,255],
		[200,168,147,255],
		[200,168,147,255],
		[200,168,147,255],
		[207,176,142,255],
		[207,176,142,255],
		[207,176,142,255],
		[207,176,142,255],
		[194,160,152,255],
		[194,160,152,255],
		[194,160,152,255],
		[194,160,152,255],
		[192,157,154,255],
		[192,157,154,255],
		[192,157,154,255],
		[192,157,154,255],
		[192,157,154,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[148,103,189,255],
		[148,103,189,255],
		[148,103,189,255],
		[148,103,189,255],
		[148,103,189,255],
		[148,103,189,255],
		[148,103,189,255],
		[148,103,189,255],
		[148,103,189,255],
		[201,169,146,255],
		[199,166,148,255],
		[199,166,148,255],
		[199,166,148,255],
		[199,166,148,255],
		[203,171,145,255],
		[203,171,145,255],
		[203,171,145,255],
		[203,171,145,255],
		[191,157,154,255],
		[192,158,153,255],
		[192,158,153,255],
		[192,158,153,255],
		[192,158,153,255],
		[190,155,155,255],
		[190,155,155,255],
		[190,155,155,255],
		[190,155,155,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[210,180,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[209,179,140,255],
		[207,176,142,255],
		[207,176,142,255],
		[207,176,142,255],
		[207,176,142,255],
		[207,176,142,255],
		[208,177,141,255],
		[208,177,141,255],
		[208,177,141,255],
		[208,177,141,255],
		[208,177,141,255]]).astype("uint8")
	mdl=session.open_command.open_data("/Users/albertsmith/Documents/Jobs/Berlin2021/Figures/HETs.cxs")[0]
	session.models.add(mdl)
	rc(session,"~display")
	rc(session,"~ribbon")
	if len(session.models)>1:
		atoms=session.models[1].atoms
		rc(session,"display #1.1")
	else:
		atoms=session.models[0].atoms
		rc(session,"display #1")
	hide=getattr(atoms,"hides")
	hide[:]=1
	hide[di]=0
	setattr(atoms,"hides",hide)
	rc(session,"style ball")
	rc(session,"size stickRadius 0.2")
	rc(session,"color all tan")
	r0=getattr(atoms,"radii").copy()
	clr0=getattr(atoms,"colors").copy()
	r0[:]=.8
	r0[ids]=r
	clr0[ids]=clr
	setattr(atoms,"radii",r0)
	setattr(atoms,"colors",clr0)
	rc(session,"save /Users/albertsmith/Documents/Jobs/Berlin2021/Figures/HETs_1_rho4.png transparentBackground true")
except:
	pass
finally:
	os.remove("/Users/albertsmith/Documents/GitHub/pyDIFRATE/chimera/chimera_script424552.py")
	rc(session,"exit")
